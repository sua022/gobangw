{"version":3,"sources":["../js/app.jsx"],"names":["BattleCenter","listeners","Map","roomOwner","prototype","emit","msgId","message","dispatchToSelf","dispatchMessage","lanbridge","broadcastMessage","JSON","stringify","fakeServer","console","log","setTimeout","place","player","loginRspMsg","Object","assign","role","callback","get","undefined","on","msg","set","onPushData","data","json","parse","socket","onReceiveLBEvent","eventId","onCreateRoomResult","result","startScreen","style","display","battleScreen","ReactDOM","render","wrap","onJoinRoomResult","resetBtn","document","getElementById","createRoomBtn","top","getResetBtnTop","currentTurn","getCurrentTurnTop","updateCurrentTurn","onclick","joinRoomBtn","startJoinRoom","Unit","props","getStyle","pos","onClick","styleName","key","getUnitStyle","getUnitBStyle","getUnitWStyle","getUnitPosition","size","getUnitSize","left","width","height","getPieceSize","getBoardWidth","bgSize","backgroundSize","row","column","realSize","padding","getBoardPadding","body","clientWidth","Math","floor","clientHeight","onReset","isBlacksTurn","innerHTML","Board","React","Component","constructor","state","Array","fill","point","urBlack","online","componentWillMount","that","hasOwnProperty","setState","user","componentDidMount","styleArray","styleArr","slice","turn","alert","handle","n","componentDidUpdate","calculateWinner","board","r","i","arr","num","target","line","upSide","leftUp","rightUp","min","leftSide","rightSide","downSide","leftDown","rightDown"],"mappings":"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","file":"app.js","sourcesContent":["function BattleCenter() {\n    this.listeners = new Map();\n    this.roomOwner = false;\n}\n\nBattleCenter.prototype.emit = function(msgId,message,dispatchToSelf) {\n    // 发送到服务端，即广播出去\n    // this.fakeServer(msgId,message);\n    if (dispatchToSelf) {\n        this.dispatchMessage(msgId,message);\n    }\n    lanbridge.broadcastMessage(JSON.stringify({\n        \"msgId\":msgId,\n        \"message\":message\n    }))\n}\n\nBattleCenter.prototype.fakeServer = function(msgId,message) {\n    console.log(\"fakserver receive msgId:\"+msgId+\",message:\"+message);\n    if (msgId == \"chat message\") {\n        this.dispatchMessage(msgId,message);\n        setTimeout(() => {\n            this.dispatchMessage('chat message',{'place':message.place+1,'player':!message.player}); \n        }, 1000);\n    } else if (msgId == \"login\") {\n        var loginRspMsg = Object.assign(message,{role:true})\n        console.log(\"login resp:\"+loginRspMsg);\n        this.dispatchMessage(\"role\",loginRspMsg);\n    }\n}\n\nBattleCenter.prototype.dispatchMessage = function(msgId,message) {\n    var callback = this.listeners.get(msgId);\n    if (callback != undefined) {\n        callback(message);\n    }\n}\n\nBattleCenter.prototype.on = function(msg,callback) {\n    this.listeners.set(msg,callback);\n}\n\nfunction onPushData(data) {\n    var json = JSON.parse(data);\n    var msgId = json.msgId;\n    var message = json.message;\n    if (msgId == \"chat message\") {\n        socket.dispatchMessage(msgId,message);\n    }\n}\n\nfunction onReceiveLBEvent(eventId,data) {\n    console.log(\"onReceiveLBEvent:\"+eventId+\",data:\"+data);\n    if (eventId == 1) {\n        // disconnect from server\n    } else if (eventId == 2) {\n        // server stop\n    } else if (eventId == 3) {\n        // server receive client disconnect event\n    } else if (eventId == 4) {\n        onPushData(data);\n    }\n    \n}\n\nfunction onCreateRoomResult(result) {\n    startScreen.style.display='none';\n    battleScreen.style.display='block';\n    ReactDOM.render(<Board />,wrap);\n    socket.roomOwner = true\n    // socket.emit('login',{'userName':\"风清扬\"});\n\n    var loginRspMsg = Object.assign({'userName':\"风清扬\"},{role:true})\n    console.log(\"onCreateRoomResult login resp:\"+loginRspMsg);\n    socket.dispatchMessage(\"role\",loginRspMsg);\n}\n\nfunction onJoinRoomResult(result) {\n    startScreen.style.display='none';\n    battleScreen.style.display='block';\n    ReactDOM.render(<Board />,wrap);\n    socket.roomOwner = false\n    resetBtn.style.display = \"none\";\n    // socket.emit('login',{'userName':\"风清扬\"});\n    \n    var loginRspMsg = Object.assign({'userName':\"扬清风\"},{role:false})\n    console.log(\"onJoinRoomResult login resp:\"+loginRspMsg);\n    socket.dispatchMessage(\"role\",loginRspMsg);\n}\n\nvar wrap=document.getElementById('wrap');\nvar battleScreen=document.getElementById(\"battleScreen\");\nvar startScreen=document.getElementById('startScreen');\nvar socket=new BattleCenter();\nvar createRoomBtn = document.getElementById('createRoom');\nvar resetBtn = document.getElementById('resetBtn');\nresetBtn.style.top = getResetBtnTop();\nvar currentTurn = document.getElementById(\"currentTurn\")\ncurrentTurn.style.top = getCurrentTurnTop();\nupdateCurrentTurn(true)\ncreateRoomBtn.onclick = function() {\n    //lanbridge.startCreateRoom(\"onCreateRoomResult\")\n    onCreateRoomResult(\"\")\n}\nvar joinRoomBtn = document.getElementById('joinRoom');\njoinRoomBtn.onclick = function() {\n    lanbridge.startJoinRoom(\"onJoinRoomResult\")\n}\n// value.focus();\n// value.onkeydown = function(e){\n// e = e || event;\n// if (e.keyCode === 13 && this.value) {\n//     login.style.display='none';\n//     wrap.style.display='block';\n//     socket=new BattleCenter();\n//     ReactDOM.render(<Board />,\n//     document.getElementById('wrap'))\n//     socket.emit('login',{'userName':this.value});\n// }\n// }\n\nfunction Unit(props){\n   return(\n      <div className={props.style} style={getStyle(props.style,props.pos)} onClick={() => props.onClick()}></div>\n   )\n}\n\nfunction getStyle(styleName,key) {\n    if (styleName == \"unit\") {\n        return getUnitStyle(key)\n    } else if (styleName == \"unit unit-b\") {\n        return getUnitBStyle(key)\n    } else if (styleName == \"unit unit-w\") {\n        return getUnitWStyle(key)\n    }\n    console.log(\"cannot get style :\" +styleName)\n    var pos = getUnitPosition(key)\n    var size = getUnitSize()\n    return {left:pos[0]+\"px\",top:pos[1]+\"px\",width:size+\"px\",height:size+\"px\"}\n}\n\n// 获取棋子大小\nfunction getPieceSize() {\n    return (25/535) * getBoardWidth()\n}\n\nfunction getUnitWStyle(key) {\n    var size = getUnitSize()\n    var bgSize = getPieceSize()\n    var pos = getUnitPosition(key)\n    console.log(pos)\n    return {left:pos[0]+\"px\",top:pos[1]+\"px\",width:size+\"px\",height:size+\"px\",backgroundSize:bgSize+\"px\"}\n}\n\nfunction getUnitBStyle(key) {\n    var size = getUnitSize()\n    var bgSize = getPieceSize()\n    var pos = getUnitPosition(key)\n    console.log(pos)\n    return {left:pos[0]+\"px\",top:pos[1]+\"px\",width:size+\"px\",height:size+\"px\",backgroundSize:bgSize+\"px\"}\n}\n\nfunction getUnitStyle(key) {\n    var size = getUnitSize()\n    var pos = getUnitPosition(key)\n    return {left:pos[0]+\"px\",top:pos[1]+\"px\",width:size+\"px\",height:size+\"px\"}\n}\n\nfunction getUnitPosition(key) {\n    var row = key[0]\n    var column = key[1]\n    \n    var realSize = getBoardWidth() / 15 \n\n    var padding=getBoardPadding()\n\n    var left = padding + realSize * column\n    var top =  padding + realSize * row\n\n    return  [left,top]\n}\n\nfunction getBoardPadding() {\n    return (5/535) * getBoardWidth()\n}\n\nfunction getBoardWidth() {\n    return document.body.clientWidth * 0.9\n}\n\nfunction getUnitSize() {\n    var size = getBoardWidth() / 15\n    return Math.floor(size)\n}\n\nfunction getResetBtnTop() {\n   return (document.body.clientHeight / 2) + (getBoardWidth() / 2) + 25 +\"px\"\n}\nfunction getCurrentTurnTop() {\n    return (document.body.clientHeight / 2) - (getBoardWidth() / 2) - 50 +\"px\"\n }\n\n function onReset(){\n    socket.emit('reset',{\"turn\":socket.roomOwner},true);\n }\n\n function updateCurrentTurn(isBlacksTurn) {\n    if (isBlacksTurn) {\n        currentTurn.innerHTML = \"当前执棋：黑棋\"\n    } else {\n        currentTurn.innerHTML = \"当前执棋：白棋\"\n    }\n }\n\n//在线人数\n// function OnlinePlayer(props){\n//   let arr=[];\n//   for(let key in props.online){\n//      arr.push(props.online[key]);\n//   }\n//    return(\n//          <div className='online'> \n//               {arr.map(function(value,index){\n                  \n//                     if(value.hasOwnProperty('role') && value.role){\n//                          return <div key={index} className='clearfix'>\n                                    \n//                                     <Unit style='unit unit-b' />\n//                                     <div className='fl'>{value.userName}</div>\n//                                 </div>\n//                     }else if(value.hasOwnProperty('role') && !value.role){\n//                          return  <div key={index} className='clearfix'>\n                                    \n//                                     <Unit style='unit unit-w' />\n//                                     <div className='fl'>{value.userName}</div>\n//                                 </div>\n//                     }else{\n//                          return  <p key={index}>{value.userName} ：在观战</p>\n//                     }\n//               })\n//            }\n//         </div>\n//     )\n// }\n//主棋盘\nclass Board extends React.Component{\n  constructor() {\n    super();\n    this.state = {\n      'styleArr': Array(225).fill('unit'),\n      isBlacksTurn:true,\n      point:-1,\n      urBlack:null,\n      online:{}\n    };\n  }\n  componentWillMount() {\n    var that = this;\n    socket.on('role', function(msg){\n        if(msg.hasOwnProperty('role') && msg.role){\n             that.setState({urBlack: true,})\n             console.log('你是黑旗')\n        }else if(msg.hasOwnProperty('role') && !msg.role){\n            that.setState({urBlack: false,})\n            console.log('你是bai旗')\n        }else{\n             console.log('人满了，不好意思')\n        }\n    })\n     socket.on('online', function(user){\n         that.setState({online: user,});\n    })\n  }\n  componentDidMount() {\n    var that = this;\n     socket.on('chat message', function(msg){\n      //更新视图\n      const styleArray = that.state.styleArr.slice();\n      styleArray[msg.place] = that.state.isBlacksTurn ? 'unit unit-b' : 'unit unit-w';\n      updateCurrentTurn(!that.state.isBlacksTurn)\n      that.setState({\n        'styleArr':styleArray,\n         isBlacksTurn: !that.state.isBlacksTurn,\n         point:msg.place,\n         })\n    });\n    socket.on('reset',function(msg){\n        console.log('reset')\n        const styleArray = that.state.styleArr.slice();\n        styleArray.fill('unit')\n        that.setState({\n          'styleArr':styleArray,\n           point:-1,\n           });\n        ReactDOM.render(<div></div>,document.getElementById('gameover'));\n        updateCurrentTurn(msg.turn)\n        if(msg.turn){\n          alert(\"it's black's turn\")\n        }else{\n          alert(\"it's white's turn\")\n        }\n    })\n  }\n  handle(n){\n\n      //刚落子的加个css3特效\n      //\n      //\n      //\n    //   let num=0;\n    //   for(let i in this.state.online){\n    //         num++;\n    //   }\n    //   if(num<2){\n    //     alert('请等待partner')\n    //     return \n    //   }\n      //判断该谁落子\n      if(this.state.isBlacksTurn==this.state.urBlack){\n          if(this.state.styleArr[n]!='unit'){//如果落子的地方有子了，就骂他\n            alert('那有棋子了，放到别处吧');\n            return;\n        }\n        socket.emit('chat message',{'place':n,'player':this.state.isBlacksTurn},true)\n      } else {\n          alert('不该你走呢亲')\n      }\n      \n  }\n  componentDidUpdate(){\n  // 更新的时候触发\n       if(calculateWinner(this.state.styleArr,this.state.point)){\n            if(this.state.isBlacksTurn!=this.state.urBlack&&this.state.urBlack!=null){\n                   ReactDOM.render(<img src='img/victory.png' className='victory' />,\n                   document.getElementById('gameover'));\n            }else{\n                   ReactDOM.render(<img src='img/defeat.png' className='victory' />,\n                    document.getElementById('gameover'));\n            }\n           \n\n      }\n  }\n  render(){\n\n      let board=[];\n      for(let r=0;r<15;r++){\n        for(let i=0;i<15;i++){\n          board[r*15+i]=<Unit key={[r,i]} pos={[r,i]} style={this.state.styleArr[r*15+i]} onClick={() => this.handle(r*15+i)}/>\n        }\n      }\n      return(\n        <div>\n          {board}\n          <div id='gameover'></div>\n        </div>              \n      )\n    }\n}\n\nfunction calculateWinner(arr,num) {\n    var target=arr[num];\n    var line=1;\n    var upSide,leftUp,rightUp;    \n    upSide=leftUp=rightUp=Math.min(Math.floor(num/15),5);\n    //横向判断先向左后向右\n    var leftSide=Math.min(num%15,5);\n    var rightSide=Math.min(14-num%15,5);\n    //console.log('rightSide',rightSide)\n    for(let i=num-1;i>num-leftSide-1;i--){\n        if(arr[i]==target){\n            line++;\n        }else{\n           break;\n        }\n    }\n    for(let i=num+1;i<=num+rightSide;i++){\n        if(arr[i]==target){\n            line++;\n        }else{\n            break;\n        }\n    }\n    if(line==5){\n        return true;\n    }else{\n        line=1;\n    }\n    //竖向判断 先上后下\n    for(let i=num-15;i>=num-upSide*15;i=i-15){\n        if(arr[i]==target){\n            line++;\n        }else{\n            break;\n        }\n    }\n    var downSide=15-upSide\n    for(let i=num+15;i<=num+downSide*15;i=i+15){\n        if(arr[i]==target){\n            line++;\n        }else{\n            break;\n        }\n    }\n    if(line==5){\n       return true;\n    }else{\n        line=1;\n    }\n    //   斜向判断  酱紫/斜   先上后下\n    \n    rightUp=Math.min(rightUp,rightSide)//判断太靠右边了，就被右边界隔断\n    for(let i=num-14;i>=num-rightUp*14;i=i-14){\n        if(arr[i]==target){\n            line++;\n        }else{\n            break;\n        }\n    }\n    var leftDown,rightDown;\n    rightDown=leftDown=14-Math.floor(num/15);\n    leftDown=Math.min(leftDown,leftSide);//判断太靠左边了，就被左边界隔断\n    for(let i=num+14;i<=num+leftDown*14;i=i+14){\n        if(arr[i]==target){\n            line++;\n        }else{\n            break;\n        }\n    }\n    if(line==5){\n       return true;\n    }else{\n        line=1;\n    }\n    //   斜向判断   酱紫\\斜   先上后下\n    rightUp=Math.min(rightUp,leftSide)\n    for(let i=num-16;i>=num-rightUp*16;i=i-16){\n        if(arr[i]==target){\n            line++;\n        }else{\n            break;\n        }    \n    }\n    rightDown=Math.min(rightDown,rightSide)\n    for(let i=num+16;i<=num+rightDown*16;i=i+16){\n        if(arr[i]==target){\n            line++;\n        }else{\n            break;\n        }\n    }\n    if(line==5){\n       return true;\n    }else{\n        line=1;\n    }\n\n    return false;\n}"]}